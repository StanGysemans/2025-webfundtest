generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model chat {
  ChatID                  Int           @id @default(autoincrement())
  UserID1                 Int
  UserID2                 Int
  CreatedAt               DateTime?     @db.DateTime(0)
  user_chat_UserID1Touser user          @relation("chat_UserID1Touser", fields: [UserID1], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "chat_ibfk_1")
  user_chat_UserID2Touser user          @relation("chat_UserID2Touser", fields: [UserID2], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "chat_ibfk_2")
  chatmessage             chatmessage[]

  @@unique([UserID1, UserID2], map: "UserID1")
  @@index([UserID2], map: "UserID2")
}

model chatmessage {
  ChatMessageID Int       @id @default(autoincrement())
  ChatID        Int
  SenderID      Int
  MessageText   String?   @db.VarChar(500)
  SentAt        DateTime? @db.DateTime(0)
  chat          chat      @relation(fields: [ChatID], references: [ChatID], onDelete: NoAction, onUpdate: NoAction, map: "chatmessage_ibfk_1")
  user          user      @relation(fields: [SenderID], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "chatmessage_ibfk_2")

  @@index([ChatID], map: "ChatID")
  @@index([SenderID], map: "SenderID")
}

model favorite {
  FavoriteID Int       @id @default(autoincrement())
  VenueID    Int?
  UserID     Int?
  AddedAt    DateTime? @db.DateTime(0)
  venue      venue?    @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "favorite_ibfk_1")
  user       user?     @relation(fields: [UserID], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "favorite_ibfk_2")

  @@index([UserID], map: "UserID")
  @@index([VenueID], map: "VenueID")
}

model feedback {
  FeedbackID        Int       @id @default(autoincrement())
  VenueID           Int?
  UserID            Int?
  TimeStamp         DateTime? @db.DateTime(0)
  CrowdLevel        String?   @db.VarChar(50)
  UserCountEstimate Int?
  venue             venue?    @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "feedback_ibfk_1")
  user              user?     @relation(fields: [UserID], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "feedback_ibfk_2")

  @@index([UserID], map: "UserID")
  @@index([VenueID], map: "VenueID")
}

model user {
  UserID                          Int           @id @default(autoincrement())
  FirstName                       String?       @db.VarChar(100)
  LastName                        String?       @db.VarChar(100)
  PasswordHash                    String?       @db.VarChar(255)
  Age                             Int?
  CampusCity                      String?       @db.VarChar(100)
  Gender                          String?       @db.VarChar(50)
  Bio                             String?       @db.VarChar(255)
  Role                            String?       @db.VarChar(50)
  chat_chat_UserID1Touser         chat[]        @relation("chat_UserID1Touser")
  chat_chat_UserID2Touser         chat[]        @relation("chat_UserID2Touser")
  chatmessage                     chatmessage[]
  favorite                        favorite[]
  feedback                        feedback[]
  friend_friend_RequestedByTouser friend[]      @relation("friend_RequestedByTouser")
  friend_friend_UserID1Touser     friend[]      @relation("friend_UserID1Touser")
  friend_friend_UserID2Touser     friend[]      @relation("friend_UserID2Touser")
  user_role                       user_role[]
  usercontact                     usercontact[]
}

model usercontact {
  UserContactID Int     @id @default(autoincrement())
  UserID        Int
  Email         String? @db.VarChar(100)
  UserPhone     String? @db.VarChar(20)
  user          user    @relation(fields: [UserID], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "usercontact_ibfk_1")

  @@index([UserID], map: "UserID")
}

model venue {
  VenueID      Int            @id @default(autoincrement())
  Name         String         @db.VarChar(100)
  Description  String?        @db.VarChar(255)
  OpeningHours Json?
  MaxCap       Int?
  AveragePrice String?        @db.VarChar(50)
  VenueTypeID  Int?
  OwnerID      Int?
  favorite     favorite[]
  feedback     feedback[]
  venuetype    venuetype?     @relation(fields: [VenueTypeID], references: [VenueTypeID], onDelete: NoAction, onUpdate: NoAction, map: "venue_ibfk_1")
  venueaddress venueaddress[]
  venuecontact venuecontact[]
  venuefoto    venuefoto[]
  venuestatus  venuestatus[]

  @@index([VenueTypeID], map: "VenueTypeID")
}

model venueaddress {
  VenueAddressID Int      @id @default(autoincrement())
  VenueID        Int?
  Address        String?  @db.VarChar(100)
  PostalCode     String?  @db.VarChar(20)
  City           String?  @db.VarChar(100)
  Lat            Decimal? @db.Decimal(9, 6)
  Lng            Decimal? @db.Decimal(9, 6)
  venue          venue?   @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "venueaddress_ibfk_1")

  @@index([VenueID], map: "VenueID")
}

model venuecontact {
  VenueContactID Int     @id @default(autoincrement())
  VenueID        Int?
  Email          String? @db.VarChar(100)
  Phone          String? @db.VarChar(20)
  WebsiteURL     String? @db.VarChar(255)
  venue          venue?  @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "venuecontact_ibfk_1")

  @@index([VenueID], map: "VenueID")
}

model venuefoto {
  VenueFotoID Int    @id @default(autoincrement())
  VenueID     Int
  Foto        Bytes?
  venue       venue  @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "venuefoto_ibfk_1")

  @@index([VenueID], map: "VenueID")
}

model venuestatus {
  StatusID          Int       @id @default(autoincrement())
  VenueID           Int?
  TimeStamp         DateTime? @db.DateTime(0)
  CrowdLevel        String?   @db.VarChar(50)
  UserCountEstimate Int?
  IsOpen            Boolean?
  venue             venue?    @relation(fields: [VenueID], references: [VenueID], onDelete: NoAction, onUpdate: NoAction, map: "venuestatus_ibfk_1")

  @@index([VenueID], map: "VenueID")
}

model venuetype {
  VenueTypeID Int     @id @default(autoincrement())
  VenueType   String  @db.VarChar(255)
  venue       venue[]
}

model friend {
  FriendID                      Int           @id @default(autoincrement())
  UserID1                       Int
  UserID2                       Int
  Status                        friend_Status @default(pending)
  RequestedBy                   Int
  CreatedAt                     DateTime?     @default(now()) @db.DateTime(0)
  user_friend_RequestedByTouser user          @relation("friend_RequestedByTouser", fields: [RequestedBy], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "fk_friend_requested")
  user_friend_UserID1Touser     user          @relation("friend_UserID1Touser", fields: [UserID1], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "fk_friend_user1")
  user_friend_UserID2Touser     user          @relation("friend_UserID2Touser", fields: [UserID2], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "fk_friend_user2")

  @@unique([UserID1, UserID2], map: "unique_friend_pair")
  @@index([RequestedBy], map: "fk_friend_requested")
  @@index([UserID2], map: "fk_friend_user2")
}

model role {
  RoleID    Int         @id @default(autoincrement())
  Name      String      @unique(map: "Name") @db.VarChar(50)
  user_role user_role[]
}

model user_role {
  UserRoleID Int  @id @default(autoincrement())
  UserID     Int
  RoleID     Int
  role       role @relation(fields: [RoleID], references: [RoleID], onDelete: NoAction, onUpdate: NoAction, map: "fk_userrole_role")
  user       user @relation(fields: [UserID], references: [UserID], onDelete: NoAction, onUpdate: NoAction, map: "fk_userrole_user")

  @@unique([UserID, RoleID], map: "UserID")
  @@index([RoleID], map: "fk_userrole_role")
}

enum friend_Status {
  pending
  accepted
  blocked
}
